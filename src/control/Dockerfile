# Python 3.10 slim ì´ë¯¸ì§€ ì‚¬ìš©
FROM python:3.10-slim

# ì‘ì—… ë””ë ‰í† ë¦¬ ì„¤ì •
WORKDIR /app

# ì˜ì¡´ì„± íŒŒì¼ ë³µì‚¬ ë° ì„¤ì¹˜
COPY requirements.txt /app/

# pipë¥¼ ìµœì‹  ë²„ì „ìœ¼ë¡œ ì—…ê·¸ë ˆì´ë“œ í›„ ì˜ì¡´ì„± ì„¤ì¹˜
RUN apt-get update && apt-get install -y \
    libgl1-mesa-glx \
    libglib2.0-0 \
    git


# # 2ï¸âƒ£ YOLOv5 ë‹¤ìš´ë¡œë“œ (ê¸°ì¡´ ìºì‹œ ì œê±° í›„ ê°•ì œ ë‹¤ìš´ë¡œë“œ)
# RUN git clone --depth 1 https://github.com/ultralytics/yolov5.git /app/yolov5
#     # 2ï¸âƒ£ YOLOv5 íŒ¨í‚¤ì§€ ì„¤ì¹˜ (pip install .)

# # 2ï¸âƒ£ YOLOv5 ë””ë ‰í† ë¦¬ í™•ì¸ (ë””ë²„ê¹…)
# RUN echo "ğŸ” YOLOv5 ë””ë ‰í† ë¦¬ êµ¬ì¡°:" && ls -l /app/yolov5 && \
#     echo "ğŸ” í˜„ì¬ ì‘ì—… ë””ë ‰í† ë¦¬:" && pwd


# # 3ï¸âƒ£ YOLOv5 í´ë” í™•ì¸ (ë””ë²„ê¹…ìš©)
# RUN ls -l /app/yolov5 || echo "ğŸš¨ YOLOv5 ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨"


RUN pip install --upgrade pip && \
    pip install --no-cache-dir -r requirements.txt


# RUN pip list | grep yolov5 || echo "YOLOv5 ì„¤ì¹˜ ì•ˆë¨"
# RUN python -c "import yolov5" || echo "YOLOv5 import ì‹¤íŒ¨"
    


# í•„ìš”í•œ ì¶”ê°€ íŒ¨í‚¤ì§€ ì„¤ì¹˜

# RUN apt-get update -y && \
#     apt-get install -y libgl1-mesa-glx libglib2.0-0 && \
#     rm -rf /var/lib/apt/lists/*

# ì†ŒìŠ¤ ì½”ë“œ ë³µì‚¬
COPY . /app/

# ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰
CMD ["python", "test.py"]

# sudo docker run --network host -it  507c10e0d63f /bin/bash
